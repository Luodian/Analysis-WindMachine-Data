题目思考？现有时间序列算法适用性？针对于室温，金融数据，网络流量数据的算法，需要剥离其针对性，使其能够针对于我们自身的数据（机械，油温等）运行



特征的定义依赖于我们对业务的理解。比较常见的特征包括：

- 当前值和过去一分钟的环比值
- 当前值和昨天同样时刻的同比值
- 当前值和上周同样时刻的同比值
- 当前值和过去一段时间的中位数差值

从特征提取到判断异常，依赖异常检测算法。在最初的阶段，我们判断一个异常往往是用特征之间的规则组合。并且，规则的阈值也是一个人为的经验。比如，地图流量环比增加了30%，同步也增加了30%，加上当前并没有特定的事件（如北京下了一场罕见的大雨。注意，这个事件也是一个特征），那么我们人为当前的流量发生了一些异常。这个异常是由什么产生的，还要结合当前的其他特征数据来判定。按照以上的方法，那么我们需要这样做：

1. 实时计算各个特征数据
2. 人工配置特征之间的计算方法和阈值，成为报警规则

随着系统的扩大、数据的增多，为每一个事件配置规则已经越来越困难了。并且，以上的规则的组合方式、阈值的选取有相当多的经验成分。用数据取代经验，是智能时代的趋势。

如果没有历史样本的标注，我们可以用无监督学习的方式，判断当前是否异常。但是由于实时性的需求，无监督学习的方案很难实现。样本的标注方案可以采取以下的选择：

1. 先用无监督学习学习历史数据，产生的结果结合人工的经验进行标注。如聚类后某一类都是异常数据；
2. 采取一些特定的算法，标注一定是有问题的数据，作为黑样本。然后去抽样正常数据，作为白样本。一种常见的黑样本标注方法是，每个特征都计算出历史的分布状况，如果当前值的某一个特征在历史分布的区间很远（例如超过历史95分位值的100%，或者已知满足正态分布，超过均值三倍标准差），那么我们认为这个值是异常的。

有了黑白样本，我们就能进行训练了。训练好模型后，结合线上实时的数据可以计算当前值是否有异常，做到异常实时报警。

以上的算法区分的有没有异常，是一个二分类问题。对于要判断异常类型和产生的原因，是多分类问题，可以采取同样类似的方法：在前期通过特征组合，定义规则；有样本标注后，可以采用多分类的学习和预测方法，对实时数据进行判断。

综上所述，一个完整的解决方案如下：

![img](http://yangsha.me/wp-content/uploads/2017/05/异常检测-1024x625.png)

